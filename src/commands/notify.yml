description: >
  This command echos "Hello World" using file inclusion.

parameters:
  channel:
    default: $SLACK_DEFAULT_CHANNEL
    description: >
      Select which channel in which to post to. Channel name or ID will work.
      You may include a comma separated list of channels if you wish to post to
      multiple channels at once. Set the "SLACK_DEFAULT_CHANNEL" environment
      variable for the default channel.
    type: env_var_name
  circle_token:
    default: $CIRCLE_TOKEN
    type: env_var_name

steps:
  - checkout
  - run:
      name: Get project slug
      command: <<include(scripts/get_project_slug.sh)>>
  - run:
      name: Install datediff command
      command: <<include(scripts/install_datediff.sh)>>
  - run:
      name: Collect flaky tests & generate slack template
      command: <<include(scripts/collect_flaky_tests.sh)>>
  - slack/notify:
      template: SLACK_TEMPLATE_FOR_FLAKY_TESTS
      channel: << parameters.channel >>

